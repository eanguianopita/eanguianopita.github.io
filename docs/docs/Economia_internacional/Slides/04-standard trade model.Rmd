---
title: "Teor√≠a del comercio internacional"
subtitle: "Clase 3. Modelo est√°ndar de comercio"
author: "Emmanuel Anguiano"
date: "Oto√±o 2025"
output:
  xaringan::moon_reader:
    css: ['default', 'metropolis', 'metropolis-fonts', 'my-css.css']
    self_contained: false
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      

---



class: inverse, middle

```{r Setup, include = F}
options(htmltools.dir.version = FALSE)
library(pacman)
p_load(ggthemes, viridis, knitr, dslabs, gapminder, extrafont, Ecdat, wooldridge, tidyverse, magrittr)
#devtools::install_github("R-CoderDotCom/econocharts")

library(econocharts)
# Define colors
red_pink <- "#e64173"
met_slate <- "#272822" 
turquoise <- "#20B2AA"
orange <- "#FFA500"
red <- "#fb6107"
blue <- "#2b59c3"
green <- "#8bb174"
grey_light <- "grey70"
grey_mid <- "grey50"
grey_dark <- "grey20"
purple <- "#6A5ACD"
slate <- "#314f4f"
# Notes directory
dir_slides <- "~/Semana 1/01-Intro"
# Knitr options
opts_chunk$set(
  comment = "#>",
  fig.align = "center",
  fig.height = 7,
  fig.width = 10.5,
  warning = F,
  message = F
)  
opts_chunk$set(dev = "svg")
options(device = function(file, width, height) {
  svg(tempfile(), width = width, height = height)
})
options(crayon.enabled = F)
options(knitr.table.format = "html")
```

```{css, echo = F, eval = F}
@media print {
  .has-continuation {
    display: block !important;
  }
}
```

# Pr√≥logo 
---
# Recapitulando

**¬øQu√© hemos hecho hasta ahora?**

* Formalizar el modelo ricardiano de 2x2. 

* Resolver el modelo en .hi-pink[autarqu√≠a] y .hi-purple[libre comercio]

* Repasamos como resolver los problemas de optimizaci√≥n del consumidor y el productor. 

* Estudiamos la validez de la teor√≠a de la ventaja comparativa en la vida real (caso de Jap√≥n S. XIX). 


--


**¬øPara d√≥nde vamos?**

* Formalizar los modelos de comercio incluyendo los siguientes nuevos supuestos: 
  - El equilibrio mundial se determina mediante las interacciones de la oferta y la demanda.
  - Costos de oportunidad crecientes.
  - Estudiar los efectos de los t√©rminos de intercambio en el comercio.


---

class: inverse, middle

.bigger[.center[.white[**Del modelo ricardiano al neocl√°sico**]]]

---

# Modelo est√°ndar vs. modelo ricardiano

### üåè Modelo ricardiano

- Se basa en **diferencias tecnol√≥gicas** entre pa√≠ses. 
- Supone un solo factor productivo: __trabajo__
- Cada pa√≠s se especializa en el bien que puede producir con un menor costo relativo. 
- Predicci√≥n: el comercio siempre genera **ganancias mutuas**. 


--

### üåê Modelo est√°ndar de comercio 

- Generaliza el modelo ricardiano: 
  - **M√∫ltiples factores de producci√≥n**
  - Preferencias de los consumidores. 
  - **Curvas de oferta y demanda** 
- Analiza como se determinan los .hi-pink[precios relativos] y los .hi-pink[t√©rminos de intercambio].
- Explica las razones del comercio y: 
  - Como se distribuyen las ganancias. 
  - Efectos sobre los factores internos. 

---

# ¬øQu√© a√±adimos al modelo de Ricardo?

* Precios en dinero (USD), $p_{x}, p_{y}$. 

* Otros factores productivos con  .hi-pink[rendimientos decrecientes]. 

* Los costos de oportunidad para producir son crecientes. 

* Efectos del desarrollo econ√≥mico de los pa√≠ses y sus pol√≠ticas comerciales. 

---

class: inverse, middle

.bigger[.center[.white[**FPP con costos crecientes**]]]

---
# Factores de la producci√≥n (I)

$$ q = Af(t,l,k)$$

* En econom√≠a normalmente consideramos los siguientes insumos como .hi-pink[**factores productivos**]: 

```{r,results="asis", echo = F}
tribble(
  ~"Factor", ~"Due√±o", ~"Pago/ganancia",
  "Tierra (t)", "Terratenientes", "Renta",
  "Trabajo (l)", "Trabajadores", "Salario",
  "Capital (k)", "Capitalistas", "Inter√©s",
) %>%
  knitr::kable(., format="html")
```
* $A:$ "Productividad total de los factores (ideas/conocimientos/instituciones).

* **Empresarios**: Reciben beneficios.

---
# Producto marginal del trabajo

.pull-left[* El .hi-pink[Producto Marginal del Trabajo (PMgT)]: la unidad adicional producida al a√±adir una unidad adicional de trabajo (manteniendo $k$ constante)

$$ PMgT = \frac{\Delta Y}{\Delta L}$$

* $PMgT$ es la pendiente de la curva de producci√≥n total (PT) en cada valor de $L$]

.pull-right[
```{r, fig.retina=3, fig.height=7, echo = F}
prod_1=function(x){2*sqrt(x)}

ggplot(data.frame(x=c(0,6)), aes(x=x))+
  stat_function(fun=prod_1, geom="line", size=2, color="red")+
  geom_label(aes(x=5,y=prod_1(5)), color = "red", label=expression(TP==2*sqrt(l)), size = 6)+
    scale_x_continuous(breaks=seq(0,6,1),
                     limits=c(0,6),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=seq(0,6,1),
                     limits=c(0,6),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_colour_manual("I.C. equations", values = colors)+
  guides(color = F)+
  labs(x = "Insumo (l)",
       y = "Producto (y)")+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
```

```{r, fig.retina=3, fig.height=7, echo =F}
mp=function(x){1/sqrt(x)}

ggplot(data.frame(x=c(0,10)), aes(x=x))+
  stat_function(fun=mp, geom="line", size=2, color="blue")+
  geom_label(aes(x=1,y=mp(1)), color = "blue", label=expression(MP[l]==frac(1,sqrt(l))), size = 4)+
    scale_x_continuous(breaks=seq(0,6,1),
                     limits=c(0,6),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=seq(0,6,1),
                     limits=c(0,6),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_colour_manual("I.C. equations", values = colors)+
  guides(color = F)+
  labs(x = "Insumo (l)",
       y = "Producto por trabajador (Y/l)")+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
```

]

---
# Producto marginal del capital 

.pull-left[* El .hi-pink[producto marginal del capital (PmgK)]: la unidad adicional producida al a√±adir una unidad adicional de capital (manteniendo $l$ constante)

$$ PMgK = \frac{\Delta Y}{\Delta K}$$
* $PMgK$ es la pendiente de la producci√≥n total en cada valor de K.] 


.pull-right[

```{r, fig.retina=3, fig.height=7, echo = F}
ggplot(data.frame(x=c(0,6)), aes(x=x))+
  stat_function(fun=prod_1, geom="line", size=2, color="red")+
  geom_label(aes(x=5,y=prod_1(5)), color = "red", label=expression(TP==2*sqrt(k)), size = 6)+
    scale_x_continuous(breaks=seq(0,6,1),
                     limits=c(0,6),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=seq(0,6,1),
                     limits=c(0,6),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_colour_manual("I.C. equations", values = colors)+
  guides(color = F)+
  labs(x = "Insumo (k)",
       y = "Producto (y)")+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
```

```{r, fig.retina=3, fig.height=7, echo = F}
mp=function(x){1/sqrt(x)}

ggplot(data.frame(x=c(0,10)), aes(x=x))+
  stat_function(fun=mp, geom="line", size=2, color="blue")+
  geom_label(aes(x=1,y=mp(1)), color = "blue", label=expression(MP[k]==frac(1,sqrt(k))), size = 4)+
    scale_x_continuous(breaks=seq(0,6,1),
                     limits=c(0,6),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=seq(0,6,1),
                     limits=c(0,6),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_colour_manual("I.C. equations", values = colors)+
  guides(color = F)+
  labs(x = "Insumo (k)",
       y = "Producto por Maquina (Y/k)")+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
```

]

---
# Rendimientos decrecientes 

.pull-left[* La .purple[Ley de rendimientos decrecientes]: a√±adir m√°s de un factor productivo a la producci√≥n **manteniendo todo lo dem√°s constante** resultar√° en una disminuci√≥n de la producci√≥n (Y). 

* Para incrementar la producci√≥n, se necesitan incrementar ¬°todos los factores!]

.pull-right[

```{r, fig.retina=3, fig.height=7, echo = F}
ggplot(data.frame(x=c(0,6)), aes(x=x))+
  stat_function(fun=prod_1, geom="line", size=2, color="red")+
  geom_label(aes(x=5,y=prod_1(5)), color = "red", label=expression(TP==2*sqrt(l)), size = 6)+
# 1 to 2
  geom_segment(x=1,xend=1,y=0,yend=prod_1(1), linetype="dotted", size =1)+
  geom_segment(x=0,xend=1,y=prod_1(1),yend=prod_1(1), linetype="dotted", size =1)+
  geom_segment(x=2,xend=2,y=0,yend=prod_1(2), linetype="dotted", size =1)+
  geom_segment(x=0,xend=2,y=prod_1(2),yend=prod_1(2), linetype="dotted", size =1)+
  annotate("segment", x = 1, xend = 2, y = 1, yend = 1, color = "purple", size=2, alpha=0.9, arrow=arrow(length=unit(0.5,"cm"), ends="last", type="closed"))+
  annotate("segment", x = 1, xend = 1, y = 2, yend = prod_1(2), color = "purple", size=2, alpha=0.9, arrow=arrow(length=unit(0.5,"cm"), ends="last", type="closed"))+
    scale_x_continuous(breaks=seq(0,6,1),
                     limits=c(0,6),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=seq(0,6,1),
                     limits=c(0,6),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_colour_manual("I.C. equations", values = colors)+
  guides(color = F)+
  labs(x = "Insumo (l)",
       y = "Producci√≥n (y)")+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
```

```{r, fig.retina=3, fig.height=7, echo = F}
mp=function(x){1/sqrt(x)}

ggplot(data.frame(x=c(0,10)), aes(x=x))+
  stat_function(fun=mp, geom="line", size=2, color="blue")+
  geom_label(aes(x=1,y=mp(1)), color = "blue", label=expression(MP[l]==frac(1,sqrt(l))), size = 4)+
    scale_x_continuous(breaks=seq(0,6,1),
                     limits=c(0,6),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=seq(0,6,1),
                     limits=c(0,6),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_colour_manual("I.C. equations", values = colors)+
  guides(color = F)+
  labs(x = "Insumo (l)",
       y = "Producto por trabajador (y/l)")+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
```
]




---

# Mercados competitivos

* Seguiremos suponiendo que los mercados de bienes y factores (tierra, trabajo y capital) son perfectamente competitivos. 

* Las empresas contratar√°n empleados hasta el punto en el que el costo marginal de una unidad adicional de $l$ o $k$ sea igual al beneficio marginal de la producci√≥n. 

* En equilibrio, cada factor productivo recibe como pago su producto marginal: 

$$p_{l} = p_y \times PMgL$$
$$p_{k} = p_y  \times PMgK$$
* M√∫ltiples combinaciones  de $l$ y $k$ pueden producir cantidades equivalentes de $y$.

* .purple[**Conclusi√≥n clave**]: Los empresarios sustituir√°n entre trabajo y capital dependiendo de los precios relativos de los insumos y la tecnolog√≠a. 

---
# FPP: Costos crecientes

.pull-left[

* .hi-pink[Tasa Marginal de Transformaci√≥n (TMT)]: _.hi-purple[incrementa]_ a medida que se produce m√°s de un bien: 
  _ "**Pendiente**", "**precio relativo de $x$**, "**costo de oportunidad de $x$**". 
  - Cantidad del bien $y$ que se sacrifica para obtener una unidad adicional de $x$
  
  $$-\frac{p_x}{p_y}$$
  
* $A \rightarrow B$ se incrementa el costo de producir $x$. 

* $A \leftarrow B$ se incrementa el costo de producir $y$
]
  
.pull-right[  
```{r, echo = F, fig.height=12}
library(ggrepel)

base_ppf_eq=function(x){sqrt(16-x^2)}

base_ppf<-ggplot(tibble(x=0:10), aes(x=x))+

  # PPF 
  stat_function(fun=base_ppf_eq, geom="line", size=2, color = "blue")+
  geom_label(x = 3.5, y = base_ppf_eq(3.5), label = "PPF", color = "blue")+

  
  # annotate("text", x = (0.5*(m/px)+1.75), y = BC(0.5*(m/px)), label = expression(paste("slope =", - l[x]/l[y])), color="blue", size =7)+
  scale_x_continuous(breaks=seq(0,5),
                     limits=c(0,5),
                     expand=expansion(mult=c(0,0.1))
                     )+
  scale_y_continuous(breaks=seq(0,5),
                     limits=c(0,5),
                     expand=expansion(mult=c(0,0.1))
                     )+
  labs(x = "x",
       y = "y")+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)


points_slope<-tribble(
  ~x, ~y, ~letter,
  1.75, 3.625, "A",
  3.325, 2.25, "B"
)

slope_A=function(x){4.5-0.5*x}
slope_B=function(x){7.25-1.5*x}

base_ppf_2 = base_ppf+
  stat_function(fun = slope_A, geom="line", linetype = "dashed", color = "red", size = 1)+
  stat_function(fun = slope_B, geom="line", linetype = "dashed", color = "darkred", size = 1)+
  geom_point(data = points_slope,
             aes(x = x,
                 y = y),
             size = 3)+
  geom_text_repel(data = points_slope,
             aes(x = x,
                 y = y,
                 label = letter),
             seed = 4,
             size = 4)

base_ppf_2+
  annotate("segment", x = 3.325, xend = 1.75, y = 2.25, yend = 3.625, colour = "purple", size=2, alpha=1, arrow=arrow(length=unit(0.5,"cm"), ends="last", type="closed"))


```
]


---
# Curvatura de la FPP  

.pull-left[ ¬øQu√© causa la forma (curva) de la FPP?

* Rendimientos decrecientes de cada factor de la producci√≥n $(\downarrow PMgL, PMgK, PmgT)$ _ceteris paribus_. 

* Sustituci√≥n de los factores de la producci√≥n y combinaciones basadas en sus precios relativos. 

* Movimiento a la izquierda/derecha $\implies$ cambios en los precios relativos entre $x$ e $y$. 

$$\left(\frac{p_x}{p_y} \right)^{1} \implies \left(\frac{p_x}{p_y}\right)^{2}$$
]

.pull-right[

```{r, echo = F, fig.height=12}
base_ppf_2+
  geom_label(x = 4.5, y=slope_A(4.5), label = expression(frac(p[x],p[y])^{1}), color = "red")+
  geom_label(x = 4.5, y=slope_B(4.5), label = expression(frac(p[x],p[y])^{2}), color = "darkred")
```


]

---
# Producci√≥n √≥ptima en autarqu√≠a (I)

.pull-left[

* Un pa√≠s inicia en .hi-pink[**autarqu√≠a**] sin comercio internacional. 

* ¬øEn que parte de la FPP eligir√° producir? Debe encontrar una combinaci√≥n **√≥ptima** de $(x,y)$. 

* Cada punto en la FPP determina los precios relativos $(p_x / p_y)$. 

  - Es una curva, por lo que cada punto tiene diferente pendiente (derivada).]
  
.pull-right[

```{r, echo = F, fig.height=12}
base_ppf_2+
  geom_label(x = 4.5, y=slope_A(4.5), label = expression(frac(p[x],p[y])^{1}), color = "red")+
  geom_label(x = 4.5, y=slope_B(4.5), label = expression(frac(p[x],p[y])^{2}), color = "darkred")
```
]

---
# Producci√≥n √≥ptima en autarqu√≠a (II)


.pull-left[

**Supuesto**: El pa√≠s producir√° pensando en maximizar el valor de mercado de su producci√≥n. 

1. **Elige**: .hi-purple[**Un conjunto de producci√≥n y una cesta de consumo**]

2. **Que maximice**: .hi-green[**su valor de mercado**].

3. **Sujeto a**: .hi-red[**tecnolog√≠a y precios de mercado**]
]

.pull-right[

```{r, echo = F, fig.height=12}
base_ppf
```
]

---
# Producci√≥n √≥ptima en autarqu√≠a (III)

.pull-left[

* Dados unos precios de autarqu√≠a, $p_x$ y $p_y$: 

$$p_x X + p_y Y = V$$
* Describe la ecuaci√≥n de las .hi-purple[**l√≠neas de isovalor**]:
  - Cada l√≠nea: conjunto de combinaciones de $x$ y $y$ que tienen el mismo valor de mercado. 
  - L√≠neas m√°s altas $\implies$ mayor valor de mercado. 

* Resolviendo la gr√°fica para $y$:  

$$y =\frac{V}{p_y}-\frac{p_x}{p_y} V$$
]




.pull-right[
```{r, echo = F, fig.height=12}
slope_a_n2=function(x){3.5-0.5*x}
slope_a_n1=function(x){4-0.5*x}
slope_a_1=function(x){5-0.5*x}
slope_a_2=function(x){5.5-0.5*x}

iso<-base_ppf+
  stat_function(fun = slope_a_n2, geom="line", linetype = "dashed", color = "#B8DE29FF", size = 1)+
  stat_function(fun = slope_a_n1, geom="line", linetype = "dashed", color = "#73D055FF", size = 1)+
  stat_function(fun = slope_A, geom="line", linetype = "dashed", color = "#3CBB75FF", size = 1)+
  stat_function(fun = slope_a_1, geom="line", linetype = "dashed", color = "#238A8DFF", size = 1)+
  geom_label(x=4, y =4.5, label = expression(paste("Pendientes isovalor = ", -frac(p[x],p[y]))))
iso
```

]


---

# Producci√≥n √≥ptima en autarqu√≠a (IV)

.pull-left[

$$ y = \frac{V}{p_y}-\color{red}{\frac{p_x}{p_y}}x$$
* La .hi-pink[**pendiente**] es el precio relativo de $x$ en t√©rminos de $y$. 

* Dado $p_x$ y $p_y$, el √≥ptimo se ubica en el punto en el que la PFF es .hi-purple[**tangente**] a la l√≠nea m√°s .hi-red[**alta**].  
* **Punto A**: maximiza el valor de mercado de la producci√≥n bajo las restricciones existentes. 

]

.pull-right[

```{r, echo = F, fig.height=12}

iso+
  stat_function(fun = slope_A, geom="line", color = "#3CBB75FF", size = 2)+
  geom_point(data = subset(points_slope, letter=="A"),
             aes(x = x,
                 y = y),
             size = 3)+
  geom_text_repel(data = subset(points_slope, letter=="A"),
             aes(x = x,
                 y = y,
                 label = letter),
             seed = 4,
             size = 4)
```
]


---
# Isovalor y precios relativos 


.pull-left[

$$ y = \frac{V}{p_y}-\color{red}{\frac{p_x}{p_y}}x$$

* Si los precios relativos .hi-turquoise[**cambian**] (en autarqu√≠a): 

$$\left(\frac{p_x}{p_y}\right)^{1} \rightarrow \left( \frac{p_x}{p_y}\right)^{2}$$

existir√° un nuevo conjunto de l√≠neas isovalor con diferente .hi-turquoise[**pendiente**].

  - El √≥ptimo en autarqu√≠a ser√° un punto diferente que es tangente a la nueva pendiente de la linea isovalor (**punto B**). 


]

.pull-right[
```{r, echo = F, fig.height= 12}
slope_b_n1=function(x){6.75-1.5*x}
slope_b_1=function(x){7.75-1.5*x}

iso2<-base_ppf+
  stat_function(fun = slope_A, geom="line", linetype = "dashed", color = "#3CBB75FF", size = 1)+
  stat_function(fun = slope_B, geom="line", linetype = "dotted", color = "#2D708EFF", size = 1)+
  stat_function(fun = slope_b_n1, geom="line", linetype = "dotted", color = "#238A8DFF", size = 1)+
  stat_function(fun = slope_b_1, geom="line", linetype = "dotted", color = "#39568CFF", size = 1)+
  geom_point(data = points_slope,
             aes(x = x,
                 y = y),
             size = 3)+
  geom_text_repel(data = points_slope,
             aes(x = x,
                 y = y,
                 label = letter),
             seed = 4,
             size = 4)
iso2
```


]


---

class: inverse, middle

.bigger[.center[.white[**Curvas de indiferencia**]]]

---
# Curvas de indiferencia

.pull-left[

* Considera un conjunto de bienes $x$ e $y$: $A = (2,5)$
]

.pull-right[
```{r, echo = F, fig.height=12}
IC=function(x){10/x}

apts<-tribble(
  ~letter, ~x, ~y,
  "A", 2, 5,
  "B", 5, 2,
  "C", 10, 1,
)

ggplot(data.frame(x=c(0,10)), aes(x=x))+
  geom_point(data = subset(apts, letter=="A"),
             mapping=aes(x=x, y=y),
             size = 3)+
  geom_text_repel(data = subset(apts, letter=="A"),
             mapping=aes(x=x, y=y,
             label = letter),
             seed = 4,
             size = 4)+
  scale_x_continuous(breaks=seq(0,10,1),
                     limits=c(0,10),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=seq(0,10,1),
                     limits=c(0,10),
                     expand=expand_scale(mult=c(0,0.1)))+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
```


]

---
# Curvas de indiferencia

.pull-left[

* Considera un conjunto de bienes $x$ e $y$: $A = (2,5)$

* Considera otro conjunto: $B=(5,2)$
  - M√°s de $x$ pero menos de $y$
]

.pull-right[
```{r, echo = F, fig.height=12}
ggplot(data.frame(x=c(0,10)), aes(x=x))+
  geom_point(data = subset(apts, letter %in% c("A","B")),
             mapping=aes(x=x, y=y),
             size = 3)+
  geom_text_repel(data = subset(apts, letter%in% c("A","B")),
             mapping=aes(x=x, y=y,
             label = letter),
             seed = 4,
             size = 4)+
  scale_x_continuous(breaks=seq(0,10,1),
                     limits=c(0,10),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=seq(0,10,1),
                     limits=c(0,10),
                     expand=expand_scale(mult=c(0,0.1)))+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
```
]

---

# Curvas de indiferencia

.pull-left[

* Considera un conjunto de bienes $x$ e $y$: $A = (2,5)$

* Considera otro conjunto: $B=(5,2)$
  - M√°s de $x$ pero menos de $y$
  
* Considera un tercer conjunto: $C=(10,1)$ 
  - A√∫n m√°s de $x$ pero tambi√©n menos de $y$. 
]

.pull-right[
```{r, echo = F, fig.height=12}
ggplot(data.frame(x=c(0,10)), aes(x=x))+
  geom_point(data = apts,
             mapping=aes(x=x, y=y),
             size = 3)+
  geom_text_repel(data = apts,
             mapping=aes(x=x, y=y,
             label = letter),
             seed = 4,
             size = 4)+
  scale_x_continuous(breaks=seq(0,10,1),
                     limits=c(0,10),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=seq(0,10,1),
                     limits=c(0,10),
                     expand=expand_scale(mult=c(0,0.1)))+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
```


]


---

# Curvas de indiferencia

.pull-left[

* Considera un conjunto de bienes $x$ e $y$: $A = (2,5)$

* Considera otro conjunto: $B=(5,2)$
  - M√°s de $x$ pero menos de $y$
  
* Considera un tercer conjunto: $C=(10,1)$ 
  - A√∫n m√°s de $x$ pero tambi√©n menos de $y$. 
  
* Supongamos que eres indiferente entre $A \sim B \sim C$. Estas canastas est√°n sobre la misma .hi-blue[**curva de indiferencia**]. 
]

.pull-right[
```{r, echo = F, fig.height=12}
IC<-ggplot(data.frame(x=c(0,10)), aes(x=x))+
  stat_function(fun=IC, geom="line", size=2, color="blue")+
  geom_point(data = apts,
             mapping=aes(x=x, y=y),
             size = 3)+
  geom_text_repel(data = apts,
             mapping=aes(x=x, y=y,
             label = letter),
             seed = 4,
             size = 4)+
  scale_x_continuous(breaks=seq(0,10,1),
                     limits=c(0,10),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=seq(0,10,1),
                     limits=c(0,10),
                     expand=expand_scale(mult=c(0,0.1)))+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
IC
```


]


---
# Curvas de indiferencia

.pull-left[

* Un pa√≠s es .hi-pink[**indiferente**] entre todos los conjuntos de la misma curva de indeferencia. 

* Los conjuntos **sobre** la curva son .hi-green[**preferidos**] a los que se encuentran por debajo. 

  - $D \succ A \sim B \sim C$
  - En una .hi-green[**curva m√°s alta**]
]

.pull-right[

```{r, echo = F, fig.height= 12}

apts2<-tribble(
  ~letter, ~x, ~y,
  "A", 2, 5,
  "B", 5, 2,
  "C", 10, 1,
  "D", 5, 5,
)

fill<-tibble(fx=seq(0,10,0.1),
             fymin=10/fx,
             ymax=rep(10,length(fx))
)

IC2=function(x){25/x}

ggplot(data.frame(x=c(0,10)), aes(x=x))+
  stat_function(fun=IC2, geom="line", size=2, color="green")+
  geom_ribbon(data=fill,aes(x=fx,ymin=fymin,ymax=ymax),fill="green", alpha=0.4)+
  stat_function(fun=IC, geom="line", size=2, color="blue")+
  geom_point(data = apts2,
             mapping=aes(x=x, y=y),
             size = 3)+
  geom_text_repel(data = apts2,
             mapping=aes(x=x, y=y,
             label = letter),
             seed = 4,
             size = 4)+
  scale_x_continuous(breaks=seq(0,10,1),
                     limits=c(0,10),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=seq(0,10,1),
                     limits=c(0,10),
                     expand=expand_scale(mult=c(0,0.1)))+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
```

]


---
# Curvas de indiferencia

.pull-left[

* Un pa√≠s es .hi-pink[**indiferente**] entre todos los conjuntos de la misma curva de indeferencia. 

* Los conjuntos **sobre** la curva son .hi-green[**preferidos**] a los que se encuentran por debajo. 

  - $D \succ A \sim B \sim C$
  - En una .hi-green[**curva m√°s alta**]
  
* Las combinaciones **debajo** de la curva son .hi-red[**menos preferidos**] que los conjuntos sobre la curva

  - $E \prec A \sim B \sim C$
  - En una curva m√°s .hi-red[**baja**]
]

.pull-right[

```{r, echo = F, fig.height= 12}

apts3<-tribble(
  ~letter, ~x, ~y,
  "A", 2, 5,
  "B", 5, 2,
  "C", 10, 1,
  "D", 5, 5,
  "E", 2, 2
)

fill2<-tibble(fx=seq(0,10,0.1),
             fymin=rep(0, length(fx)),
             ymax=10/fx)

IC3=function(x){4/x}

ggplot(data.frame(x=c(0,10)), aes(x=x))+
  stat_function(fun=IC2, geom="line", size=2, color="green")+
  stat_function(fun=IC3, geom="line", size=2, color="red")+
  geom_ribbon(data=fill2,aes(x=fx,ymin=fymin,ymax=ymax),fill="red", alpha=0.4)+
  stat_function(fun=IC, geom="line", size=2, color="blue")+
  geom_rect(aes(xmin=0,xmax=1,ymin=0,ymax=10), fill="red", alpha=0.25)+
  geom_point(data = apts3,
             mapping=aes(x=x, y=y),
             size = 3)+
  geom_text_repel(data = apts3,
             mapping=aes(x=x, y=y,
             label = letter),
             seed = 4,
             size = 4)+
  scale_x_continuous(breaks=seq(0,10,1),
                     limits=c(0,10),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=seq(0,10,1),
                     limits=c(0,10),
                     expand=expand_scale(mult=c(0,0.1)))+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
```

]


---
# Tasa marginal de sustitucion (TMS)

.pull-left[

* .hi-pink[**Tasa marginal de sustituci√≥n**]: La tasa a la cu√°l el consumidor intercambia entre uno u otro bien y permanece indiferente. 

* **Costo de oportunidad**: # de unidades de $y$ que se sacrifican para adquirir una unidad adicional de $x$. 
]

.pull-right[

* TMS es la pendiente de la curva de indiferencia
  - $TMS_{x,y} = - \frac{\Delta y}{\Delta x} = \frac{\text{incremento}}{\text{sacrifico}}$
  
* Cantidad de $y$ que se sacrifica para obtener una unidad adicional de $x$

* La TMS cambia a lo largo de la curva. 
]

---

class: inverse, middle

.bigger[.center[.white[**√ìptimo en autarqu√≠a**]]]

---
# Equilibrio dom√©stico 

.pull-left[

* El pa√≠s .blue[Dom√©stico] produce y consume en la curva de indiferencia m√°s alta que es tangente a su FPP. 

* En el √≥ptimo .blue[Dom√©stico] de autarqu√≠a: 

$$\underbrace{TMT}_{\text{Pendiente FPP}} = \underbrace{TMS}_{\text{Pendiente CI}} =\underbrace{\left(\frac{p_x}{p_y}\right)}_{\text{linea de precios}}$$
* Estos son los .hi-pink[**precios relativos en autarqu√≠a**] del pa√≠s .blue[Dom√©stico]. Es decir, los precios en los que el pa√≠s maximiza su bienestar. ]

.pull-right[
```{r, echo = F, fig.height= 12}
home_point<-tribble(
  ~x, ~y, ~letter,
  2, 2.75, "A"
)

home_ppf_eq =function(x){sqrt(9-(x-0.75)^2)}
home_IC_1 = function(x){1.75+(2/x)}
home_price_1 = function(x){3.75-0.5*x}

home_ppf_1<-ggplot(data.frame(x=c(0,10)), aes(x=x))+
  stat_function(fun = home_ppf_eq, geom = "line", color = "blue", size = 1)+
  geom_label(x = 3.5, y = home_ppf_eq(3.5), label = "PPF", size = 3, color = "blue")+
  
  stat_function(fun = home_IC_1, geom = "line", color = "green", size = 1)+
  geom_label(x = 3.5, y = home_IC_1(3.5), label = "IC", size = 3, color = "green")+
  stat_function(fun = home_price_1, geom = "line", color = "purple", size = 1, linetype = "dashed")+
  geom_segment(x = 0, xend = 2, y = 2.75, yend = 2.75, linetype = "dotted", size = 1)+
  geom_segment(x = 2, xend = 2, y = 2.75, yend = 0, linetype = "dotted", size = 1)+
  geom_point(data = home_point,
             mapping=aes(x=x, y=y),
             size = 3)+
  geom_text_repel(data = home_point,
             mapping=aes(x=x, y=y,
             label = letter),
             seed = 4,
             size = 4)+
  scale_x_continuous(breaks=c(0,2),
                     labels=c(0, expression(x[1])),
                     limits=c(0,5),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=c(0,2.75),
                     labels=c(0, expression(y[1])),
                     limits=c(0,5),
                     expand=expand_scale(mult=c(0,0.1)))+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
home_ppf_1
```
]


---
# Equilibrio extranjero

.pull-left[

* El pa√≠s .red[Extranjero] (con diferente FPP) tambi√©n produce y consume en la CI m√°s alta que es tangente a su FPP. 

* El √≥ptimo en autarqu√≠a del pa√≠s .red[extranjero]: 

$$\underbrace{TMT}_{\text{Pendiente FPP}} = \underbrace{TMS}_{\text{Pendiente CI}} =\underbrace{\left(\frac{p_x}{p_y}\right)}_{\text{linea de precios}}$$


* Estos son los .hi-pink[**precios relativos en autarqu√≠a**] del pa√≠s .red[Extranjero]. Es decir, los precios en los que el pa√≠s maximiza su bienestar. ]

.pull-right[

```{r, echo = F, fig.height=12}
foreign_point<-tribble(
  ~x, ~y, ~letter,
  2.55, 3, "A'"
)

foreign_ppf_eq =function(x){sqrt(25-x^3)}
foreign_IC_1 = function(x){4/(x-1.575)-1}
foreign_price_1 = function(x){12.5-3.75*x}

foreign_ppf_1<-ggplot(data.frame(x=c(0,10)), aes(x=x))+
  stat_function(fun = foreign_ppf_eq, geom = "line", color = "red", size = 1, xlim=c(0,4.1))+
  geom_label(x = 3.5, y = foreign_ppf_eq(3.5), label = "PPF", size = 3, color = "blue")+
  geom_segment(x = 2.91, y = 0.6, xend = 2.93, yend = 0, color = "red", size = 1)+
  
  stat_function(fun = foreign_IC_1, geom = "line", color = "green", size = 1)+
  geom_label(x = 3.5, y = foreign_IC_1(3.5), label = "IC", size = 3, color = "green")+
  stat_function(fun = foreign_price_1, geom = "line", color = "purple", size = 1, linetype = "dashed")+
  geom_segment(x = 0, xend = 2.55, y = 3, yend = 3, linetype = "dotted", size = 1)+
  geom_segment(x = 2.55, xend = 2.55, y = 3, yend = 0, linetype = "dotted", size = 1)+
  geom_point(data = foreign_point,
             mapping=aes(x=x, y=y),
             size = 3)+
  geom_text_repel(data = foreign_point,
             mapping=aes(x=x, y=y,
             label = letter),
             seed = 4,
             size = 4)+
  scale_x_continuous(breaks=c(0,2.55),
                     labels=c(0, expression(x[1]*minute)),
                     limits=c(0,5),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=c(0,3),
                     labels=c(0, expression(y[1]*minute)),
                     limits=c(0,5),
                     expand=expand_scale(mult=c(0,0.1)))+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
foreign_ppf_1
```
]

---
# Precios relativos en autarqu√≠a 

.pull-left[

### .hi-blue[Dom√©stico]

```{r, fig.height=7, echo = F}
home_ppf_1
```
]

.pull-right[

### .hi-red[Extranjero]

```{r, fig.height=7, echo = F}
foreign_ppf_1
```
]

.smallest[
- El pa√≠s .blue[Dom√©stico] tiene ventaja comparativa en $x$; exporta dicho bien. 

- El pa√≠s .red[Extranjero] tiene ventaja comparativa en $y$, exporta dicho bien. 
]

---
# Ventaja comparativa

.pull-left[

### .hi-blue[Dom√©stico]

```{r, fig.height=7, echo = F}
home_ppf_1
```
]

.pull-right[

### .hi-red[Extranjero]

```{r, fig.height=7, echo = F}
foreign_ppf_1
```
]

.smallest[
- El pa√≠s .blue[Dom√©stico] y .red[Extranjero] tienen .hi-purple[diferentes precios relativos en autarqu√≠a]

- Precio relativo de $x$ (pendiente de FPP) es menor en el pa√≠s  .blue[Dom√©stico] que en el .red[Extranjero]

$$\color{blue}{\left(\frac{p_x}{p_y}\right)} < \color{red}{\left(\frac{p_x}{p_y}\right)'}$$

]

---


class: inverse, middle

.bigger[.center[.white[**Mercado mundial para el bien X**]]]

---
# Mercado del bien x: Dom√©stico

.pull-left[

### .hi-blue[Dom√©stico]

```{r, fig.height=9, echo = F}
home_ppf_1
```
]

.pull-right[

### Oferta .hi-blue[Dom√©stica] de x

```{r, fig.height=9, echo = F}
export_points <- tribble(
  ~x, ~y, ~letter,
  1, 1, "A",
  2, 2, "B"
)

ggplot(data = tibble(x = 1:10), aes(x = x)) +
  # L√≠nea escalera azul
  geom_segment(x = 0, xend = 1, y = 1, yend = 1, size = 2, color = "blue") +
  geom_segment(x = 1, xend = 2, y = 1, yend = 2, size = 2, color = "blue") +

  # Puntos A y B
  geom_point(data = export_points,
             aes(x = x, y = y),
             size = 2) +

  # Letras A y B
  geom_text_repel(data = export_points,
                  aes(x = x, y = y, label = letter),
                  seed = 2,
                  size = 4) +

  # L√≠neas punteadas desde A
  geom_segment(x = 1, xend = 1, y = 1, yend = 1, size = 1, linetype = "dotted") +
  geom_segment(x = 1, xend = 1, y = 1, yend = 0, size = 1, linetype = "dotted") +

  # L√≠neas punteadas desde B
  geom_segment(x = 0, xend = 2, y = 2, yend = 2, size = 1, linetype = "dotted") +
  geom_segment(x = 2, xend = 2, y = 2, yend = 0, size = 1, linetype = "dotted") +

  # Ejes y etiquetas
  labs(y = expression(frac(p[x], p[y]))) +
  scale_x_continuous(
    breaks = c(0, 1, 2),
    labels = c(0, expression(x[1]), expression(x[2])),
    limits = c(0, 3),
    expand = expansion(mult = c(0, 0.1))
  ) +
  scale_y_continuous(
    breaks = c(0, 1, 2),
    labels = c(0,
               expression(frac(p[x]^H, p[y]^H)),
               expression(frac(p[x]^2, p[y]^2))),
    limits = c(0, 4),
    expand = expansion(mult = c(0, 0.1))
  ) +

  # Tema gr√°fico
  theme_classic(base_family = "Fira Sans Condensed", base_size = 16) +
  theme(axis.title.y = element_text(angle = 0, vjust = 0.5))

```

]

.smallest[
- El pa√≠s .blue[Dom√©stico] est√° exportando $x$.
- En la medida en que el precio relativo de $x$ (pendiente)  $\uparrow$ desde $\left(\frac{p_x}{p_y}\right)^{H} \rightarrow \left(\frac{p_x}{p_y}\right)^{2}$, .blue[Dom√©stico] exportar√° m√°s $x$. 


]

---
# Mercado del bien x: Extranjero

.pull-left[

### .hi-red[Extranjero]

```{r foreign-imp, fig.height=9, echo = F}
import_b=tribble(
  ~x, ~y, ~letter,
  1.95, 4.2, "B'"
)

foreign_ppf_world_price = function(x){7.15-1.5*x}

foreign_imp<-ggplot(data.frame(x=c(0,10)), aes(x=x))+
  stat_function(fun = foreign_ppf_eq, geom = "line", color = "red", size = 1, xlim=c(0,4.1))+
  geom_label(x = 3.5, y = foreign_ppf_eq(3.5), label = "PPF", size = 3, color = "blue")+
  geom_segment(x = 2.91, y = 0.6, xend = 2.93, yend = 0, color = "red", size = 1)+
  
  stat_function(fun = foreign_IC_1, geom = "line", color = "green", size = 1)+
  geom_label(x = 3.5, y = foreign_IC_1(3.5), label = "IC", size = 3, color = "green")+
  stat_function(fun = foreign_price_1, geom = "line", color = "purple", size = 1, linetype = "dashed")+
  geom_segment(x = 0, xend = 2.55, y = 3, yend = 3, linetype = "dotted", size = 1)+
  geom_segment(x = 2.55, xend = 2.55, y = 3, yend = 0, linetype = "dotted", size = 1)+
  geom_point(data = foreign_point,
             mapping=aes(x=x, y=y),
             size = 3)+
  geom_text_repel(data = foreign_point,
             mapping=aes(x=x, y=y,
             label = letter),
             seed = 4,
             size = 4)+
geom_point(data = import_b,
             aes(x = x,
                 y = y),
             size = 3)+
  geom_text_repel(data = import_b,
             aes(x = x,
                 y = y,
                 label = letter),
             seed = 4, 
             size = 4)+
  stat_function(fun = foreign_ppf_world_price, geom = "line", size = 1, linetype = "dashed", color = "darkorchid4")+
  geom_segment(x = 0, xend = 1.95, y = 4.2, yend = 4.2, linetype = "dotted", size = 1)+
  geom_segment(x = 1.95, xend = 1.95, y = 4.2, yend = 0, linetype = "dotted", size = 1)+
  scale_x_continuous(breaks=c(0,1.95, 2.55),
                     labels=c(0, expression(x[2]*minute), expression(x[1]*minute)),
                     limits=c(0,5),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=c(0,3, 4.2),
                     labels=c(0, expression(y[1]*minute), expression(y[2]*minute)),
                     limits=c(0,5),
                     expand=expand_scale(mult=c(0,0.1)))+
  theme_classic(base_family = "Fira Sans Condensed", base_size=20)
foreign_imp
```
]

.pull-right[

Demanda de importaciones del .hi-red[Extranjero]

```{r x-imp, fig.height=9, echo = F}
library(tibble)
library(ggplot2)
library(ggrepel)

import_points <- tribble(
  ~x, ~y, ~letter,
  1, 3, "A'",
  2, 2, "B'"
)

ggplot(data = tibble(x = 1:10), aes(x = x)) +
  # L√≠nea escalera azul
  geom_segment(x = 0, xend = 1, y = 3, yend = 3, size = 2, color = "red") +
  geom_segment(x = 1, xend = 2, y = 3, yend = 2, size = 2, color = "red") +

  # Puntos A‚Ä≤ y B‚Ä≤
  geom_point(data = import_points,
             aes(x = x, y = y),
             size = 2) +

  # Letras A‚Ä≤ y B‚Ä≤
  geom_text_repel(data = import_points,
                  aes(x = x, y = y, label = letter),
                  seed = 2,
                  size = 4) +

  # L√≠neas punteadas desde A‚Ä≤
  geom_segment(x = 0, xend = 1, y = 3, yend = 3, size = 1, linetype = "dotted") +
  geom_segment(x = 1, xend = 1, y = 3, yend = 0, size = 1, linetype = "dotted") +

  # L√≠neas punteadas desde B‚Ä≤
  geom_segment(x = 0, xend = 2, y = 2, yend = 2, size = 1, linetype = "dotted") +
  geom_segment(x = 2, xend = 2, y = 2, yend = 0, size = 1, linetype = "dotted") +

  # Ejes y etiquetas
  labs(y = expression(frac(p[x], p[y]))) +
  scale_x_continuous(
    breaks = c(0, 1, 2),
    labels = c(0, expression(x[1]), expression(x[2])),
    limits = c(0, 3),
    expand = expansion(mult = c(0, 0.1))
  ) +
  scale_y_continuous(
    breaks = c(0, 2, 3),
    labels = c(0,
               expression(frac(p[x]^2, p[y]^2)),
               expression(frac(p[x]^F, p[y]^F))),
    limits = c(0, 4),
    expand = expansion(mult = c(0, 0.1))
  ) +

  # Tema gr√°fico
  theme_classic(base_family = "Fira Sans Condensed", base_size = 16) +
  theme(axis.title.y = element_text(angle = 0, vjust = 0.5))

```

]

.smallest[
- El .red[Extranjero] importar√° el bien $x$

- En la medida en que su precio relativo (pendiente) $\downarrow$ from $\left(\frac{p_x}{p_y}\right)^{F} \rightarrow \left(\frac{p_x}{p_y}\right)^{2}$, .red[Extranjero] importa m√°s de $x$
]


---
# Mercado mundial del bien x


.pull-left[

* Uniendo la .blue[oferta de exportaciones Dom√©sticas] y la .red[demanda de importaciones Extranjeras] para $x$

* .hi-pink[**Precio relativo mundial de equilibrio**] de $x$: 
  $\left(\frac{p_x}{p_y}\right)^{2}$ logra balancear las exportaciones e importaciones de ambos pa√≠ses. 
]

.pull-right[

```{r, echo = F, fig.height= 10}
market_points<-tribble(
  ~x, ~y, ~letter,
  1, 1, "A",
  1, 3, "A'",
  2, 2, "B, B'"
)

ggplot(data = tibble(x = 1:10), aes(x = x))+
  geom_segment(x = 0, xend = 1, y = 3, yend = 3, size = 2, color = "red")+
  geom_segment(x = 1, xend = 3, y = 3, yend = 1, size = 2, color = "red")+
  geom_segment(x = 0, xend = 1, y = 1, yend = 1, size = 2, color = "blue")+
  geom_segment(x = 1, xend = 3, y = 1, yend = 3, size = 2, color = "blue")+
  geom_point(data = market_points,
             aes(x = x,
                 y = y),
             size = 2)+
  geom_text_repel(data = market_points,
             aes(x = x,
                 y = y,
                 label = letter),
             seed = 2,
             size = 4)+
  geom_segment(x = 0, xend = 2, y = 2, yend = 2, size = 1, linetype = "dotted")+
  geom_segment(x = 2, xend = 2, y = 2, yend = 0, size = 1, linetype = "dotted")+
  geom_segment(x = 1, xend = 1, y = 3, yend = 3, size = 1, linetype = "dotted")+
  geom_segment(x = 1, xend = 1, y = 3, yend = 0, size = 1, linetype = "dotted")+
  geom_segment(x = 0, xend = 2, y = 2, yend = 2, size = 1, linetype = "dotted")+
  geom_segment(x = 2, xend = 2, y = 2, yend = 0, size = 1, linetype = "dotted")+
  labs(y = expression(frac(p[x],p[y])))+
  scale_x_continuous(breaks=c(0,1, 2),
                     labels=c(0, expression(x[1]), expression(x[2])),
                     limits=c(0,3),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=c(0,1, 2, 3),
                     labels=c(0, expression(frac(p[x]^{H},p[y]^{H})), expression(frac(p[x]^{2},p[y]^{2})), expression(frac(p[x]^{F},p[y]^{F}))),
                     limits=c(0,4),
                     expand=expand_scale(mult=c(0,0.1)))+
  theme_classic(base_family = "Fira Sans Condensed", base_size=14)+
  theme(axis.title.y = element_text(angle = 0, vjust = 0.5))
```
]

---
# Mercado mundial del bien x

.pull-left[

* Ambos pa√≠ses iniciar√°n en autarqu√≠a (.blue[A], .red[A']) con diferentes precios relativos para el bien $x$
  - Es m√°s barato en el pa√≠s .blue[Dom√©stico] (tiene ventaja comparativa)
  - M√°s caro en el .red[Extranjero] (desventaja comparativa)
  
* El equilibrio con comercio se alcanza en el punto (B,B'), en donde los pa√≠ses tienen el mismo precio relativo mundial: 

$$\left(\frac{p_x}{p_y}\right)^{D} < \left(\frac{p_x}{p_y}\right)^{2} < \left(\frac{p_x}{p_y}\right)^{E}$$

]

.pull-right[
```{r, echo = F, fig.height= 10}
market_points<-tribble(
  ~x, ~y, ~letter,
  1, 1, "A",
  1, 3, "A'",
  2, 2, "B, B'"
)

ggplot(data = tibble(x = 1:10), aes(x = x))+
  geom_segment(x = 0, xend = 1, y = 3, yend = 3, size = 2, color = "red")+
  geom_segment(x = 1, xend = 3, y = 3, yend = 1, size = 2, color = "red")+
  geom_segment(x = 0, xend = 1, y = 1, yend = 1, size = 2, color = "blue")+
  geom_segment(x = 1, xend = 3, y = 1, yend = 3, size = 2, color = "blue")+
  geom_point(data = market_points,
             aes(x = x,
                 y = y),
             size = 2)+
  geom_text_repel(data = market_points,
             aes(x = x,
                 y = y,
                 label = letter),
             seed = 2,
             size = 4)+
  geom_segment(x = 0, xend = 2, y = 2, yend = 2, size = 1, linetype = "dotted")+
  geom_segment(x = 2, xend = 2, y = 2, yend = 0, size = 1, linetype = "dotted")+
  geom_segment(x = 1, xend = 1, y = 3, yend = 3, size = 1, linetype = "dotted")+
  geom_segment(x = 1, xend = 1, y = 3, yend = 0, size = 1, linetype = "dotted")+
  geom_segment(x = 0, xend = 2, y = 2, yend = 2, size = 1, linetype = "dotted")+
  geom_segment(x = 2, xend = 2, y = 2, yend = 0, size = 1, linetype = "dotted")+
  labs(y = expression(frac(p[x],p[y])))+
  scale_x_continuous(breaks=c(0,1, 2),
                     labels=c(0, expression(x[1]), expression(x[2])),
                     limits=c(0,3),
                     expand=expand_scale(mult=c(0,0.1)))+
  scale_y_continuous(breaks=c(0,1, 2, 3),
                     labels=c(0, expression(frac(p[x]^{H},p[y]^{H})), expression(frac(p[x]^{2},p[y]^{2})), expression(frac(p[x]^{F},p[y]^{F}))),
                     limits=c(0,4),
                     expand=expand_scale(mult=c(0,0.1)))+
  theme_classic(base_family = "Fira Sans Condensed", base_size=14)+
  theme(axis.title.y = element_text(angle = 0, vjust = 0.5))
```
]

---

exclude: true

```{R generate pdfs, include = F, eval = F}
#remotes::install_github('rstudio/pagedown')
library(pagedown)
pagedown::chrome_print("03-ricardian.html", output = "03-ricardian.pdf")
```
